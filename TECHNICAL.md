# ü§ñ –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø –î–õ–Ø –ò–ò-–ê–°–°–ò–°–¢–ï–ù–¢–û–í

> **–í–µ—Ä—Å–∏—è:** 2.0.1  
> **–î–∞—Ç–∞:** 2026-02-15  
> **–¶–µ–ª—å:** –ë—ã—Å—Ç—Ä—ã–π onboarding –ò–ò –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

## üìê –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –°–ò–°–¢–ï–ú–´

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Nginx Proxy Manager                   ‚îÇ
‚îÇ                   (npm_default network)                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ                       ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ   GLPI System     ‚îÇ   ‚îÇ  Chatwoot System  ‚îÇ
    ‚îÇ  glpi2.yapomogu   ‚îÇ   ‚îÇ  chat2.yapomogu   ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ                      ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  v2_glpi:80       ‚îÇ   ‚îÇ v2_chatwoot:3000  ‚îÇ
    ‚îÇ  v2_glpi_db       ‚îÇ   ‚îÇ v2_chatwoot_db    ‚îÇ
    ‚îÇ  (MariaDB 10.11)  ‚îÇ   ‚îÇ (PostgreSQL 15)   ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ v2_chatwoot_redis ‚îÇ
                            ‚îÇ v2_chatwoot_sidekiq‚îÇ
                            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Volumes (named, managed by Docker):
  GLPI:     v2_glpi_files, v2_glpi_plugins, v2_glpi_config, 
            v2_glpi_marketplace, v2_glpi_db_data
  Chatwoot: v2_chatwoot_storage, v2_chatwoot_db_data, 
            v2_chatwoot_redis_data
```

### –ü–∞—Ç—Ç–µ—Ä–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏
- **–ü—Ä–µ—Ñ–∏–∫—Å v2_** –¥–ª—è –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, volumes)
- **–î–æ–º–µ–Ω—ã *2.yapomogu.com** –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º
- **Shared network** npm_default –¥–ª—è NPM –¥–æ—Å—Ç—É–ø–∞
- **Internal network** backend –¥–ª—è –º–µ–∂–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ–π —Å–≤—è–∑–∏

---

## üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

```
helpdesk-stack-npm/
‚îú‚îÄ‚îÄ docker-compose.yml      # –ì–ª–∞–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (278 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ .env                    # –°–µ–∫—Ä–µ—Ç—ã (–ù–ï –≤ Git)
‚îú‚îÄ‚îÄ .env.example            # –®–∞–±–ª–æ–Ω —Å–µ–∫—Ä–µ—Ç–æ–≤ (–í Git)
‚îú‚îÄ‚îÄ .gitignore              # Git –∏—Å–∫–ª—é—á–µ–Ω–∏—è
‚îÇ
‚îú‚îÄ‚îÄ Deployment Scripts:
‚îÇ   ‚îú‚îÄ‚îÄ init.sh             # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ install.sh          # –ü–µ—Ä–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ quick-start.sh      # –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫
‚îÇ   ‚îú‚îÄ‚îÄ backup.sh           # –ë—ç–∫–∞–ø volumes —á–µ—Ä–µ–∑ Docker
‚îÇ   ‚îú‚îÄ‚îÄ restore.sh          # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ volumes
‚îÇ   ‚îî‚îÄ‚îÄ status.sh           # –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
‚îÇ
‚îî‚îÄ‚îÄ Documentation:
    ‚îú‚îÄ‚îÄ README.md           # –û–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ DEPLOY.md           # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (297 —Å—Ç—Ä–æ–∫)
    ‚îú‚îÄ‚îÄ CHEATSHEET.md       # –ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞ (132 —Å—Ç—Ä–æ–∫–∏)
    ‚îú‚îÄ‚îÄ MIGRATION.md        # –ú–∏–≥—Ä–∞—Ü–∏—è bind mounts ‚Üí volumes
    ‚îú‚îÄ‚îÄ CHANGELOG.md        # –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π (v2.0 ‚Üí v2.0.1)
    ‚îî‚îÄ‚îÄ TECHNICAL.md        # ‚Üê –≠—Ç–æ—Ç —Ñ–∞–π–ª (–¥–ª—è –ò–ò)
```

---

## üîß –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –†–ï–®–ï–ù–ò–Ø

### 1. Named Volumes vs Bind Mounts
**–†–µ—à–µ–Ω–∏–µ:** Named volumes (Docker-managed)  
**–ü—Ä–∏—á–∏–Ω–∞:**
- –ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å (Windows/Linux)
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ Windows
- –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –ø—Ä–∞–≤ FS —Ö–æ—Å—Ç–∞
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ –±—ç–∫–∞–ø–∞ —á–µ—Ä–µ–∑ Docker

**–ü—É—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö:**
```yaml
# GLPI (diouxx/glpi)
/var/www/html/glpi/files       ‚Üí v2_glpi_files
/var/www/html/glpi/plugins     ‚Üí v2_glpi_plugins
/var/www/html/glpi/config      ‚Üí v2_glpi_config
/var/www/html/glpi/marketplace ‚Üí v2_glpi_marketplace ‚ö†Ô∏è –ù–ï /var/www/html/marketplace
/var/lib/mysql                 ‚Üí v2_glpi_db_data

# Chatwoot (chatwoot/chatwoot)
/app/storage                   ‚Üí v2_chatwoot_storage
/var/lib/postgresql/data       ‚Üí v2_chatwoot_db_data
/data                          ‚Üí v2_chatwoot_redis_data
```

### 2. Redis URL Interpolation
**–†–µ—à–µ–Ω–∏–µ:** –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ docker-compose.yml  
**–ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω:** `REDIS_URL=${REDIS_URL}` –≤ .env —Å `${REDIS_PASSWORD}`  
**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```yaml
# docker-compose.yml
environment:
  - REDIS_URL=redis://:${REDIS_PASSWORD}@chatwoot_redis:6379
# .env (—Ç–æ–ª—å–∫–æ –ø–∞—Ä–æ–ª—å)
REDIS_PASSWORD=secret
```
**–ü—Ä–∏—á–∏–Ω–∞:** –í–ª–æ–∂–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ env_file

### 3. Health Checks
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```yaml
# GLPI
test: ["CMD-SHELL", "curl -f http://localhost/ || exit 1"]
# –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º /status.php - –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å

# Chatwoot
test: ["CMD-SHELL", "wget -q --spider http://localhost:3000/api || exit 1"]
# –ù–µ /health - —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

# MariaDB
test: ["CMD", "/usr/local/bin/healthcheck.sh", "--connect", "--innodb_initialized"]

# PostgreSQL
test: ["CMD-SHELL", "pg_isready -U ${CHATWOOT_DB_USER} -d ${CHATWOOT_DB_NAME}"]

# Redis
test: ["CMD-SHELL", "redis-cli -a $$REDIS_PASSWORD ping | grep PONG"]
# –î–≤–æ–π–Ω–æ–π $$ –¥–ª—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ compose
```

### 4. Database Initialization
**Chatwoot:** `rails db:chatwoot_prepare` ‚úÖ  
**–ò–∑–±–µ–≥–∞—Ç—å:** `rails db:schema:load` + `db:seed` –æ—Ç–¥–µ–ª—å–Ω–æ  
**–ü—Ä–∏—á–∏–Ω–∞:** `chatwoot_prepare` - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å—ë —Å—Ä–∞–∑—É

**GLPI:** –í–µ–±-—É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ  
**–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:** `docker exec v2_glpi rm /var/www/html/install/install.php`

### 5. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
**–°—Ç—Ä–∞—Ç–µ–≥–∏—è –∏–∑–æ–ª—è—Ü–∏–∏:**
```
–°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞          –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ v2
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
glpi                    v2_glpi
glpi_db                 v2_glpi_db
glpi.yapomogu.com       glpi2.yapomogu.com
./data/glpi/files       v2_glpi_files (volume)
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Zero-downtime migration

---

## üîê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### –°–µ–∫—Ä–µ—Ç—ã
1. **–í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ .env** (–∏—Å–∫–ª—é—á–µ–Ω –∏–∑ Git)
2. **Redis –∑–∞—â–∏—â–µ–Ω –ø–∞—Ä–æ–ª–µ–º** (`--requirepass`)
3. **GLPI installer —É–¥–∞–ª—è–µ—Ç—Å—è** –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
4. **Chatwoot ENABLE_ACCOUNT_SIGNUP=false** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

### –°–µ—Ç—å
```yaml
networks:
  npm_default:    # External, NPM –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è
    external: true
  backend:        # Internal, inter-service communication
    driver: bridge
```

### Resource Limits
```yaml
deploy:
  resources:
    limits:
      cpus: '${SERVICE_CPU_LIMIT}'
      memory: ${SERVICE_MEMORY_LIMIT}
    reservations:
      cpus: '0.25'
      memory: 256m
```

---

## üìù ENVIRONMENT VARIABLES

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ)
```bash
# GLPI Database
GLPI_DB_ROOT_PASSWORD=       # MariaDB root
GLPI_DB_PASSWORD=            # GLPI user password

# Chatwoot
CHATWOOT_SECRET_KEY_BASE=    # 64 bytes hex (openssl rand -hex 64)
CHATWOOT_FRONTEND_URL=       # https://chat2.yapomogu.com
CHATWOOT_DB_PASSWORD=        # PostgreSQL password

# Redis
REDIS_PASSWORD=              # Redis auth password

# SMTP
SMTP_ADDRESS=                # SMTP server
SMTP_USERNAME=               # SMTP login
SMTP_PASSWORD=               # SMTP password
```

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ (—Å –¥–µ—Ñ–æ–ª—Ç–∞–º–∏)
```bash
TZ=Asia/Omsk
CHATWOOT_DEFAULT_LOCALE=ru
GLPI_MEMORY_LIMIT=2g
CHATWOOT_MEMORY_LIMIT=2g
DB_MEMORY_LIMIT=1g
```

### –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ (—É–¥–∞–ª–µ–Ω—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞)
```bash
REDIS_URL=                   # ‚ùå –§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≤ compose
INSTALLATION_ENV=docker      # ‚ùå –ù–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è
FORCE_SSL=true               # ‚ùå –ù–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è
```

---

## üöÄ DEPLOYMENT FLOW

### First-time Installation
```bash
1. cp .env.example .env && nano .env  # –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–∞—Ä–æ–ª–∏
2. chmod +x *.sh
3. docker network create npm_default  # –ï—Å–ª–∏ –Ω–µ—Ç NPM
4. ./quick-start.sh                   # –ò–ª–∏ —Å–ª–µ–¥–æ–≤–∞—Ç—å DEPLOY.md
```

### Database Initialization
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ –ë–î
docker compose up -d v2_glpi_db v2_chatwoot_db v2_chatwoot_redis
sleep 60  # –ñ–¥–∞—Ç—å healthy

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Chatwoot
docker compose run --rm chatwoot bundle exec rails db:chatwoot_prepare

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å—ë
docker compose up -d
```

### NPM Configuration
**GLPI:**
- Domain: glpi2.yapomogu.com
- Forward: v2_glpi:80
- SSL: ‚úÖ, WebSocket: ‚ùå

**Chatwoot:**
- Domain: chat2.yapomogu.com
- Forward: v2_chatwoot:3000
- SSL: ‚úÖ, **WebSocket: ‚úÖ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û**

---

## üêõ –ò–ó–í–ï–°–¢–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò –†–ï–®–ï–ù–ò–Ø

### 1. Chatwoot unhealthy –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞
**–°–∏–º–ø—Ç–æ–º:** Container shows unhealthy, –Ω–æ –ª–æ–≥–∏ "Listening on 0.0.0.0:3000"  
**–ü—Ä–∏—á–∏–Ω–∞:** –î–æ–ª–≥–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Rails (webpack compile, migrations)  
**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–¥–æ–∂–¥–∞—Ç—å 2-5 –º–∏–Ω—É—Ç, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏  
**–ù–µ –ø—Ä–æ–±–ª–µ–º–∞ –µ—Å–ª–∏:** –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç "Listening on", –Ω–µ—Ç –æ—à–∏–±–æ–∫

### 2. GLPI marketplace –ø—É—Ç—å
**–°—Ç–∞—Ä–∞—è –æ—à–∏–±–∫–∞:** `/var/www/html/marketplace`  
**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** `/var/www/html/glpi/marketplace`  
**–ò—Å—Ç–æ—á–Ω–∏–∫:** https://github.com/Diouxx/docker-glpi

### 3. Redis connection refused
**–ü—Ä–∏—á–∏–Ω–∞:** REDIS_URL –≤ .env —Å –≤–ª–æ–∂–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–µ–π  
**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å REDIS_URL –∏–∑ .env, —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –≤ compose

### 4. Volume permissions –Ω–∞ Windows
**–†–µ—à–µ–Ω–∏–µ:** Named volumes —Ä–µ—à–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏  
**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (Linux):** `chown -R www-data:www-data` –≤ entrypoint

---

## üîÑ MAINTENANCE OPERATIONS

### Backup
```bash
./backup.sh
# –°–æ–∑–¥–∞—ë—Ç: backups/backup_YYYY-MM-DD_HH-MM-SS.tar.gz
# –°–æ–¥–µ—Ä–∂–∏—Ç: –≤—Å–µ volumes + database dumps
```

### Restore
```bash
./restore.sh backups/backup_YYYY-MM-DD_HH-MM-SS.tar.gz
```

### Update Images
```bash
docker compose pull
docker compose up -d
docker compose run --rm chatwoot bundle exec rails db:chatwoot_prepare
```

### Logs
```bash
docker compose logs -f [service]
docker logs v2_chatwoot --tail 100 --follow
```

### Database Access
```bash
# MariaDB (GLPI)
docker exec -it v2_glpi_db mysql -u glpi -p glpi

# PostgreSQL (Chatwoot)
docker exec -it v2_chatwoot_db psql -U chatwoot -d chatwoot
```

---

## üéØ –¢–û–ß–ö–ò –†–ê–°–®–ò–†–ï–ù–ò–Ø (TODO –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –ò–ò)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- [ ] **Telegram Bot –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** —Å Chatwoot
  - API Channel –≤ Chatwoot
  - Bot webhook ‚Üí Chatwoot inbox
  - –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è

- [ ] **GLPI ‚Üî Chatwoot bridge**
  - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞ GLPI –∏–∑ Chatwoot conversation
  - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤
  - API: GLPI REST API + Chatwoot Platform API

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- [ ] **Prometheus + Grafana**
  - –≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
  - –î–∞—à–±–æ—Ä–¥—ã –¥–ª—è GLPI/Chatwoot
  - –ê–ª–µ—Ä—Ç—ã –Ω–∞ disk space, memory, CPU

- [ ] **Loki –¥–ª—è –ª–æ–≥–æ–≤**
  - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤
  - –ü–æ–∏—Å–∫ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
- [ ] **Database replication**
  - MariaDB primary/replica
  - PostgreSQL streaming replication
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π failover (Patroni)

- [ ] **Redis Sentinel** –¥–ª—è HA

- [ ] **Traefik –≤–º–µ—Å—Ç–æ NPM** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
  - Load balancing
  - Better WebSocket support

### –ü—Ä–∏–æ—Ä–∏—Ç 4: CI/CD
- [ ] **GitHub Actions**
  - Lint docker-compose.yml
  - Test backup/restore
  - Automated deployments

- [ ] **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**
  - Semantic versioning
  - Release notes automation

---

## üìö –ò–°–¢–û–ß–ù–ò–ö–ò (OFFICIAL DOCS)

### GLPI Docker
- **Repo:** https://github.com/Diouxx/docker-glpi
- **Image:** docker.io/diouxx/glpi:latest
- **Paths:** –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ glpi-start.sh —Å–∫—Ä–∏–ø—Ç–µ
- **Env vars:** `TIMEZONE` (–æ—Å–Ω–æ–≤–Ω–∞—è)

### Chatwoot Docker
- **Official:** https://developers.chatwoot.com/self-hosted/deployment/docker
- **Env vars:** https://developers.chatwoot.com/self-hosted/configuration/environment-variables
- **Image:** docker.io/chatwoot/chatwoot:latest
- **DB init:** `rails db:chatwoot_prepare` (–Ω–µ migrate!)

### Docker Compose
- **Version:** Modern syntax (no `version:` field)
- **Requires:** Docker 20.10+, Compose v2+
- **Networks:** External + internal pattern
- **Health checks:** CMD-SHELL format –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω

---

## üß™ TESTING CHECKLIST

### Before Commit
- [ ] `docker compose config` –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –í—Å–µ paths –≤ volumes –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
- [ ] .env.example –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π
- [ ] .gitignore –≤–∫–ª—é—á–∞–µ—Ç .env –∏ data/
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (CHANGELOG.md)

### After Deploy
- [ ] –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã healthy: `docker compose ps`
- [ ] GLPI –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ glpi2.yapomogu.com
- [ ] Chatwoot –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ chat2.yapomogu.com
- [ ] WebSocket —Ä–∞–±–æ—Ç–∞–µ—Ç (test chat widget)
- [ ] Backup/restore —Ä–∞–±–æ—Ç–∞–µ—Ç: `./backup.sh && ./restore.sh`
- [ ] –õ–æ–≥–∏ –±–µ–∑ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫

### Stress Test
- [ ] Resource limits —Ä–∞–±–æ—Ç–∞—é—Ç (–Ω–µ OOM)
- [ ] Database –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π (ab, siege)
- [ ] Disk space monitoring
- [ ] Restart —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å: `docker compose restart`

---

## üí° BEST PRACTICES –ü–†–ò –ú–û–î–ò–§–ò–ö–ê–¶–ò–ò

### Docker Compose
1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π named volumes** —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º v2_
2. **Health checks –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã** –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
3. **depends_on —Å condition: service_healthy** –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ depends_on
4. **Resource limits** –¥–ª—è production
5. **restart: unless-stopped** –¥–ª—è –∞–≤—Ç–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### Environment Variables
1. **–°–µ–∫—Ä–µ—Ç—ã —Ç–æ–ª—å–∫–æ –≤ .env**, –Ω–∏–∫–æ–≥–¥–∞ –≤ docker-compose.yml
2. **.env.example** —Å placeholder –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
3. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å** –∫–∞–∂–¥—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö
4. **–ò–∑–±–µ–≥–∞—Ç—å** –≤–ª–æ–∂–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ (${VAR_${OTHER}})

### Volumes
1. **–ü—Ä–µ—Ñ–∏–∫—Å v2_** –¥–ª—è –≤—Å–µ—Ö volumes
2. **Explicit name:** –≤ —Å–µ–∫—Ü–∏–∏ volumes
3. **Backup strategy** —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ
4. **–ü—É—Ç–∏** –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### Scripts
1. **Bash -e** –¥–ª—è exit on error
2. **set -u** –¥–ª—è undefined variables error
3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
4. **–¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥** –¥–ª—è UX (–Ω–æ –Ω–µ –≤ CI)

### Documentation
1. **CHANGELOG.md** –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏
2. **Inline comments** –≤ docker-compose.yml
3. **Commit messages** –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ (Conventional Commits)
4. **README.md** –∞–∫—Ç—É–∞–ª—å–Ω—ã–π (single source of truth)

---

## üîç DEBUG –ö–û–ú–ê–ù–î–´

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥
docker compose config

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—é env
docker compose config | grep REDIS_URL

# –°–ø–∏—Å–æ–∫ volumes
docker volume ls | grep v2_

# –ò–Ω—Å–ø–µ–∫—Ü–∏—è volume
docker volume inspect v2_glpi_files

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏
docker network inspect npm_default

# Logs troubleshooting
docker compose logs --tail=100 --follow v2_chatwoot

# Container inspection
docker inspect v2_chatwoot | jq '.[0].State.Health'

# Resource usage
docker stats --no-stream v2_glpi v2_chatwoot

# Cleanup (–û–°–¢–û–†–û–ñ–ù–û!)
docker compose down -v  # –£–¥–∞–ª—è–µ—Ç volumes!
```

---

## üìä METRICS & KPIs

### Performance Targets
- **GLPI:** < 500ms page load
- **Chatwoot:** < 200ms API response
- **Database:** < 100ms query time (avg)
- **Uptime:** 99.5% (–¥–æ–ø—É—Å—Ç–∏–º–æ 3.6h downtime/month)

### Resource Usage (expected)
```
Container          CPU      Memory
v2_glpi            0.5-2.0  512M-2G
v2_glpi_db         0.25-1.0 256M-1G
v2_chatwoot        0.5-2.0  512M-2G
v2_chatwoot_db     0.25-1.0 256M-1G
v2_chatwoot_redis  0.1-0.5  128M-512M
v2_chatwoot_sidekiq 0.25-1.0 256M-1G
```

---

## üéì LEARNING RESOURCES

### For AI Assistants
- –ü—Ä–æ—á–∏—Ç–∞—Ç—å DEPLOY.md –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–¥ deployment –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
- –ò–∑—É—á–∏—Ç—å CHANGELOG.md –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —ç–≤–æ–ª—é—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å git log –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ä–µ—à–µ–Ω–∏–π
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –∫–æ–ø–∏–∏ –ø–µ—Ä–µ–¥ production

### For Humans
- CHEATSHEET.md - –±—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥
- README.md - –æ–±—â–∏–π –æ–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
- MIGRATION.md - –º–∏–≥—Ä–∞—Ü–∏—è —Å–æ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏

---

## ‚úÖ VALIDATION CHECKLIST (–ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π –∑–∞–¥–∞—á–∏)

–ò–ò –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

- [ ] –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã
- [ ] docker-compose.yml –≤–∞–ª–∏–¥–µ–Ω (`docker compose config`)
- [ ] .env.example —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω—É–∂–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- [ ] –ù–µ—Ç hardcoded —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –∫–æ–¥–µ
- [ ] Volumes —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º v2_
- [ ] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º v2_
- [ ] –î–æ–º–µ–Ω—ã *2.yapomogu.com
- [ ] Health checks —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] Backup/restore –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- [ ] CHANGELOG.md —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é
- [ ] Commit messages –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ
- [ ] –°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

---

## üö® RED FLAGS (—á—Ç–æ –ù–ï–õ–¨–ó–Ø –¥–µ–ª–∞—Ç—å)

‚ùå **–£–¥–∞–ª—è—Ç—å volumes –±–µ–∑ backup**  
‚ùå **–ö–æ–º–º–∏—Ç–∏—Ç—å .env —Ñ–∞–π–ª**  
‚ùå **–ú–µ–Ω—è—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å v2_ (–∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å–æ —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º–æ–π)**  
‚ùå **–£–¥–∞–ª—è—Ç—å health checks**  
‚ùå **Bind mounts –≤–º–µ—Å—Ç–æ named volumes**  
‚ùå **–•–∞—Ä–¥–∫–æ–¥–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –≤ docker-compose.yml**  
‚ùå **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `latest` –≤ production –±–µ–∑ freeze –≤–µ—Ä—Å–∏–π**  
‚ùå **–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é**  

---

## üìû –ö–û–ù–¢–ê–ö–¢–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø

**–ü—Ä–æ–µ–∫—Ç:** helpdesk-stack-npm  
**–í–µ—Ä—Å–∏—è:** 2.0.1  
**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/yofomoose/helpdesk-stack-npm  
**–î–æ–º–µ–Ω—ã:**
- GLPI: glpi2.yapomogu.com
- Chatwoot: chat2.yapomogu.com

**–°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç):**
- GLPI: glpi.yapomogu.com
- Chatwoot: chat.yapomogu.com

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-02-15  
**–ê–≤—Ç–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** GitHub Copilot (Claude Sonnet 4.5)  
**–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤:** –°–º. git log –∏ commit history
